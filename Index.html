

<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=yes">
<meta http-equiv=“Content-Security-Policy” content=“default-src ‘self’ gap://ready file://* *; style-src ‘self’ ‘unsafe-inline’; script-src ‘self’ ‘unsafe-inline’ ‘unsafe-eval’”/>
<html>
<head>
  <title>Loading the map...</title>

   <!--Facebook Load-->
<meta property="og:url"                content="https://safeinnm.com/map/">
<meta property="og:type"               content="Interactive Map" />
<meta property="og:title"              content="SAFE in Northern Michigan" />
<meta property="og:description"        content="Our Impact is a Safe in Northern Michigan initiative" />
<meta property="og:image"              content="blob:https://wordpress.com/a1fceafb-675b-494a-9cfd-c6aa6f6844ac" />

  <!-- Chrome Load -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.62.0/dist/L.Control.Locate.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.62.0/src/L.Control.Locate.min.js" charset="utf-8"></script>

  <!---Social Media Shares-->

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/vaakash/socializer@2f749eb/css/socializer.min.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css">

  <!-- jQuery-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

 <!-- Load Leaflet code library: see http://leafletjs.com/download.html -->
 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
 <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>



  <!-- Tabletop -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.js"></script>

  <!-- Font Awesome -->
  <script src="https://use.fontawesome.com/77cd9dd4f5.js"></script>

  <!-- Leaflet.awesome-markers -->
  <link rel="stylesheet" type="text/css" href="scripts/Leaflet.awesome-markers/dist/leaflet.awesome-markers.css">
  <script type="text/javascript" src="scripts/Leaflet.awesome-markers/dist/leaflet.awesome-markers.js"></script>

  <!-- Markercluster -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.0.4/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.0.4/dist/MarkerCluster.Default.css">
  <script type="text/javascript" src="https://unpkg.com/leaflet.markercluster@1.0.4/dist/leaflet.markercluster.js"></script>

  <!-- Mapzen Search
  <link rel="stylesheet" href="scripts/leaflet-geocoder/leaflet-geocoder-mapzen.css">
  <script src="scripts/leaflet-geocoder/leaflet-geocoder-mapzen.js"></script>
   -->

  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

  <!-- Locate Control -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-locatecontrol/0.60.0/L.Control.Locate.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-locatecontrol/0.60.0/L.Control.Locate.min.js"></script>

  <!-- jQuery-CSV -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

  <!-- Custom style sheet -->
  <link rel="stylesheet" type="text/css" href="style.css">

  <!-- Layer Support for Marker Cluster -->
  <script src="https://unpkg.com/leaflet.markercluster.layersupport@1.0.3/dist/leaflet.markercluster.layersupport.js"></script>

  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css" />

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body id= "stop-scrolling"> 
  <div class="preloader"></div>     
<div class="nav-right visible-xs">
    <div class="button" id="btn">
      <div class="bar top"></div>
      <div class="bar middle"></div>
      <div class="bar bottom"></div>
    </div>
  </div>

  <div class="sr-sharebar sr-sb-vl sr-sb-left">
      <div class="socializer" data-features="32px,squircle,opacity,vertical,icon-white,pad" data-sites="facebook,youtube,twitter,print" data-meta-link="http://map.safeinnm.com/" data-meta-title="Our Impact Map">
    </div>
    </div>
    <img src= "dashboardlogo.png"
         <a href= "https://datastudio.google.com/reporting/2eb8d323-89df-4b88-bc47-af63b3128551" target="_blank">
  <main>
    <div id="map" >
    <div class="button" id="btn">
    <nav>
      <div class="nav-right hidden-xs">
        
          <div class="bar top">
          </div>
          <div class="bar middle"></div>
          <div class="bar bottom"></div>
        </div>
      </div>
    </div>
    </nav>
</div>
  </main>
  
  <div class="sidebar">
        <div id="panel">
            
            <div id="gform" >
                <iframe id="form" src="https://docs.google.com/forms/d/e/1FAIpQLSflTNsBzbQ3OR951TIZp4y-fb1mh1k1fP50HtWbyVLzDVDTNA/viewform?usp=sf_link" width="100%" height="100%" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>
            </div> 
          </div>       
  </div>




<table id="maptable" class="display"></table>

</body>
<script type ="text/javascript">
$(document).ready(function() {

    function toggleSidebar() {
      $(".button").toggleClass("active");
      $("main").toggleClass("move-to-left");
      $(".sidebar-item").toggleClass("active");
    }
  
    $(".button").on("click tap", function() {
      toggleSidebar();
    });
  
    $(document).keyup(function(e) {
      if (e.keyCode === 27) {
        toggleSidebar();
      }
    });
  
  });

</script>

<script type="text/javascript">
  var map = L.map('map', {
    attributionControl: false,
    zoomControl: false,
    scrollWheelZoom: false
  }).setView([41.76,-72.69], 11); // default center is overridden by Google Sheet options and points

 /* display basemap tiles -- see others at https://leaflet-extras.github.io/leaflet-providers/preview/ */
 L.tileLayer(
    'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://osm.org/copyright">\
        OpenStreetMap</a> contributors, &copy;\
        <a href="https://carto.com/attribution">CARTO</a>'
  }).addTo(map);

  
</script>

<script> 
function preloaderFadeOutInit(){
$('.preloader').fadeOut('slow');
$('body').attr('id','');
}
// Window load function
jQuery(window).on('load', function () {
(function ($) {
preloaderFadeOutInit();
})(jQuery);

setTimeout(function(){        
  $('#preloader').fadeOut();
  $('.preloader_img').delay().fadeOut('slow'); 
}, 100000000000);

});
</script>

<script type="text/javascript" src="google-doc-url.js"></script>
<script type="text/javascript" src="scripts/constants.js"></script>
<script type="text/javascript" src="scripts/palette.js"></script>
<script type="text/javascript" src="scripts/polylabel.js"></script>
<script type="text/javascript" src="scripts/procsv.js"></script>
<script type="text/javascript" src="scripts/map.js"></script>
<script src="https://maps.google.com/maps/api/js?sensor=false"></script>
<script>
    var DATA_SERVICE_URL="https://script.google.com/macros/s/AKfycbxHrqv5x-2lCtZJ1W49q0rjU6ATnSLZWAtJADqBj1Kil32H80pL/exec?jsonp=callback";
    
    var geocoder;
    var map;
    
    function initialize() {
        //Create a geocoder
        geocoder = new google.maps.Geocoder();
        
        map=new google.maps.Map(document.getElementById('map_canvas'),{
            center:new google.maps.LatLng(42.456187,-71.0653),
            zoom:10,
            maxZoom:20,
            mapTypeId:google.maps.MapTypeId.ROADMAP
        });
        
        //Inject JavaScript (returned JSON) into the head of the page.
        var scriptElement=document.createElement('script');
        scriptElement.src=DATA_SERVICE_URL;
        document.getElementsByTagName('head')[0].appendChild(scriptElement);  
    }
    
    function callback(data) {
        for (var i=1;i<data.length;i++) {
            
            address=data[i][2];
            
            //Geocode the JSON returned from callback function.
            codeAddress();
        }
    }
    
    function codeAddress(){
        
        //Google Async service.
        geocoder.geocode({'address':address},function(results,status){
            
                if (status == google.maps.GeocoderStatus.OK) {
                    
                    var marker = new google.maps.Marker({
                        position:results[0].geometry.location,
                        map:map
                    });
                }else{
                    alert('Geocode was not successful for the following reason:' + status);
                }
            });
            
    }
    
</script>

</body>
</html>
